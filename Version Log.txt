

5.4.1.0 27/06/16
				lastPieceEjectHomeX maximim changed from 0 to 1000 to allow parameter to be used on standalone saw and flowlines
5.4.0.0 23/06/16
				isCentralised, AHOffOn and reverseOff parameters added to clamps for more programmable flexibility
				skip OutputSAM waste label if flowlineallinOne as it has already been created (stops infinite loop)
				read offcutLength, waseLength, lengthused from sawLink file to add to offcut label
				check central.saw for centralise data - but this is also read from profile.mul field 15, output by flowops. It is treated logically as [profile.mul field14] OR [central.saw]
				get flip data from field 2 in profile.mul
5.3.1.0 23/06/16	
				Bug in measuring length longer than stdlength, offcut not created properly
5.3.0.0	21/06/16
				Component directory made a parameter - componentDirectory
				catch disposing exception of creating new panel and create new one on component manual entry
5.2.7.0 15/06/16
				quarter triangles only used when SR axis exists
				Bug in saw cut height resetting to default fixed
				New parameter transferType and pigeonhole TRANSFERTABLETYPE
5.2.6.0 14/06/16 GMG
				axX referenced in frmSettings fro default speeds and acellerations - exception if axX not defined
5.2.5.0 10/06/16 GMG
				Allow SX axis on Saw machines for clamping	
5.2.4.0 07/06/16 GMG Bug found in processing offcut after bar measure - was creating offcut belonging to the original bar length, so when it cam to delete, another one was there. 
					Separated to new function measProcessOffcut(ByVal normalisedLength As Single, ByVal bar As clBar) As clOffcut

5.2.3.0 06/06/16 Removed SaveOffcuts references - was causing offcuts.saw to be rewritten each time, leading to multiple use of same offcut
5.2.2.0 03/06/16 better control of butReoptimise enable - stops it flickering and turn off on componentMode
					disable isCut tickbox on BarEdit Pieces if functionality disabled

5.2.1.0 03/06/16 On A2015, do not allow individual pieces on a bar to be cut

5.2.0.0 03/06/16 Offcuts stored in a SQLite database. On first run will load in offcuts.saw, then rename to offcuts.old
					Database updated when new offcut created or held / used flag is set
					Table stores date used to aid housekeeping of data, tables will only be deleted if date used in the past. Will only delete this record if used date well in past

5.1.0.0 26/05/16 codeDiskFriendly property added for colours to prevent slash character getting into filenames
				
5.0.0.9	24/05/16 Abort button on frmSawQueue alarms group works as Multi side
				 frmSawService exit button function added
				 print label from saw side on flowlineSaw, outputs sam file - sam code needed to be passed across the sawRecipe queue file
				 isCentraliseSaw added to work out if centralising needed from saw recipe

5.0.0.8 18/05/16 Added component entry mode with new parameter componentEntryMode
					Reads in .44p files generated by database Component Generator, used for generating standard parts
					.44p files stored in \components directory in profile subdirectories
					on manual load screen, system automatically selects component entry tab
					Operator uses + /- buttons to select qty of required components defined in precompiled bars

5.0.0.7 10/05/16 Enable FineTune V notch parameters on Autoflows with useSawForYNotch
					New parameter frontToBackVersion - set to 2 for following changes
					Clamp sturcture size increased from 5 to 10 to allow controlling axis instead of assuming X axis (SX axis)
					Also allow a timer for retraction on reverse clamping
					Increase axis structure size from 21 to 31 to allow future expansion
					Increase ioDef Structure size from 6 to 10 to allow future expansion
					Increase Alarm structure size from 7 to 15 to allow for the machine side definition (saw or MH)
					Increase Spindle structure size from 12 to 20 to allow future expansion

5.0.0.6 05/05/16 ph_PS_SAW_TURRET and parameter psZTurret
5.0.0.5 05/05/16 Bug in ClearCollections - clewared all offcut out, so offcuts could be emptied during the saving cycle. Now offcut collection only cleared on load
5.0.0.4 03/05/16 Bug in reading bParameter - should have been bParameterSaw
5.0.0.3 28/04/16 Made X & Y numbers for IO all strings, displayed on all machines, incl OYn and RYn on flowline Outputs - Not right on ZX IOs
5.0.0.2 28/04/16 Wire IO numbers corrected for 300 range
5.0.0.1 27/04/16
	Move bar queue display update to 1 second update cycle - stops the jumping and flashin on optimising and speeds it up 
	lockOptimising stops bar queu update during optimising process to ensure bar queue not updated (slows process down and unneccesary)
5.0.0.0 31/03/16
	Add saw screen to display on 2nd desktop screen
	isSawSide added to all communications systems (pigeonholes, alarms, messages, recipie, bar download)
		- all calling functions has isSawSide argument which will enable them to be easily called twice from thier controlling function
		- clController duplications to back end variable setting and fParameter / bParameter / recipie reading and writing
		- autoqueue loads queued batches - new file format for batches loads pre-compiled saw recipies
		- on compiling, saw recipe created simultaneously and standard recipe
		- New axis definition for "SX"
		- Additional recipe view in Bar data on Setting screen
	On backup - upload backup to ftp.stuga.co.uk

4.79.7.0 15/04/16
	Rewrite of measured bar length processing in bqCheckMeasured. Simplified and clarified
4.79.6.0 11/04/16
	Ensure no offcuts are written during saveOffcuts if storeOffcuts flag is set false
4.79.5.0 07/05/16
	Changed visibility of settings to GF email (speed slider, Accuracy settings, Infeed Reverse)
4.79.4.0 07/04/16
	Allow feeed direction incalculation of blade position on inverted mitres (problem since Anglian Saw program)
4.79.3.0
4.79.2.0 22/03/16
	Timestamp in offcuts log file
	SMOT, SPIN and SPDP lines skipped and does not produce warning on load as included from 4.76.0.0
		- Taking too long to carry out a software upgrade as all individual files had to be edited and saved
	usOffcutDiagnostics parameter to switch on / off offcut diagnostic file. Needed because it is v. slow when switched on
4.79.1.0 21/03/16
	Problem reporting button, logs common issues in diagnostic file
	Offcut processing logged in diagnostics
	Write diagnostic on state change of msg3 if chged to msgLIGHT_GUARD to try to track if light guard causes missed cuts
4.79.0.0 08/03/16
	CC-016123 Bug with Knife and Fork Offcut using stored offcuts, not measured one
	CC-016124 Add parameter overLengthMax - amount that optimising system will allow an overlength before modifying stdLength for all following lengths
	CC-016100 Problem reading penulinate and final line - copied same function from saw (which works ok) as winMulti was slightly different
	Implement 2016 optimiser - new parameter optimiserVersion (1= std, 2=2016)
	Log Optimisation results in a monthly file
	daily pcs file in diagnostic folder totals pieces cut
4.78.1.0
	Bug - SAM delete line had been accidentally removed
4.78.0.0
	Skip SMOT check if filename is SPINDLE
4.77.0.0 01/03/16
	Check c:\multi\backend for diagnostic data files
	*.bed are files created by controller 
	On etherCAT errors:
	time,etherCATErr Code(031),spin1,spin2,tlAng,rAng,AccState,DecState,xpos
	Read in file and store in \diagnose\etherCAT.csv, also write to dgn file
4.76.0.0 25/02/16
	Check mnd files for ou.SMOT lines - these are old-school and will create problems. Needs replacing with dp off command.
4.75.0.0 23/02/16
	Log machineUpload, axesLog, etc on TwinCAT
	Get rid of AxSpeedOverride download
4.74.0.0 17/02/16
	Deal with offcut at end when forced into a big offcut by minable problem - push up to smallestGrip and cut square
		Only happens on squareOffMinableMitre flag, only on offcutAtStart, big minable at end
	Blue pusher block added to settings 
4.73.0.0 17/02/16
	final bugs in offcut removed - Knife and fork optimisation sets held flag not used
	.off files only created if hasFuncSlaveSaw()
4.72.2.0 15/02/16
	Bug in SAM printing from 4.71.0.0 - looking for newline, caused crash
4.72.1.0 08/02/16
	Bug in want halftriangle - affecting AH cuts
4.72.0.0 08/02/16
	gripPassPos missing from parameter menu
4.71.0.0 29/01/16
	waitUnload added for Eject cuts - slight error from Autoflow conversion

4.70.0.0 27/01/16
	SecondSawHeight parameter to allow use of 2nd saw cut sensor for an efficient lower cut. 
	Default value is 0 which disables height sliders on settings screen
	If cut height > parameter then taller cut sensor used
4.69.4.0 26/01/16
	On beckhoff jog, send the axNo not AxId to the back end variable
4.69.3.0 26/01/16
	Further tweaking needed to offcut at start - stop 2nd 45 degree cut encroaching wide profiles CC-015595
4.69.2.0 22/01/16
	Bug in offcutAtStart when disposingLength is smaller than profile width - no skips chunk cuts altogether
4.69.1.0 20/01/16
	Bug in arrow head manual input, defaulting to square cut
4.69.0.0 19/01/16
	Major changes to make offcutAtStart much better. Cuits chunks at beginning of bar leaving minable if required at gripper end
	Cuts chunk cuts with blade protecting rear fences
	At gripper end, piece is held firmly, gripper moves out of way and blower deals with offcut
	Also tidied up graphical view in Service screen to help visualise cut positions
	Increased throwawayChunkSize max value, as this needs to be at least 120mm now
	maxableTrimCut now uses same algorithm
	Use mitre cuts to trim (angle depends on hand) to prevent offcut clashing with backfence

4.68.0.0 12/01/16
	skipLoadClear pep
	Bar number back on barQueue
	on quarterTriangles (Sill saw), better definition on whether lastPiece needs a quarter cut. 
	storeOffcuts parameter will now store offcuts - relaced a line in goOffcut that was missing fro createNewOffcut() function

4.67.5.0 11/01/16
	larger bmps for the profile - allows wide sill pictures
4.67.4.0 08/01/16
	on saw, use the ph_CUTSPEED as the bar feed speed on bar download - then modifed by profile feed speed if necessary
4.67.2.0 07/01/16
	bar parameters trim, isCentralised, etc were in a "clampword". This is now replicated in seperate parameters for future expansion
	New peps 
		sawClampPos used on sawingModule only. On TwinCAT cill saw this will dictate if clampPos is used
		ejB4Push - ensure ejector has returned before pushing - helps on floppier profiles
		ProfileBlock - colour coding for ancil support profile blocks
		PusherBlock - colour coding for pusher endpiece blocks
4.67.0.0 05/01/16
	Superwide cuts added in addSingleSawCut for cill saw
	Variable angles on manual input cust
	disable manual ops screen for saw
	modFunctionality module - systemised place to create hasFunc... true or false modules to make programming clearer across machine types

4.66.0.0 11/12/15
	Check userVariables on loading with exception catch
	Saw can have XY numbers on I/O screen
	new controllerType twinCat3 and associated change in port nos
	Axes downloaded with null axes inbetween, allows "gaps" in the axes setup in axis.mul, particularly when there are few axes
	MAX_AXES increased to 20 - needs equivalent change in back end
	use same manual input form as multi - needs additions to allow multi length and multi angle choice

4.65.0.0 04/12/15
	parameter psInfeedRollerLift to delay CLIT lift on Mk3 infeed
	Parameter changes now download to back end immediately (AT LAST!)
	Parameter yNotchStartGap / gaps 'y'variable. Add to W_ESYF and W_ESYR.mnd to have one point of change of Y notch at start of bar distance
	Parameter gripPassPos for G axis position when ejecting profile to transfer table - mK3 ONLY
	autoQueueNoMeasure parameter now downloaded to back-end
	Extra field in axes file to assign axisNumber. Before this, axis number was the line number in the file
		axis file, meaning null axes had to be inserted.
		On flowline Mk3, this sorts out jog / home functioning on R axis
		AxNo is the motion controller axis number (Starts at 0 on E100, 1 on TwinCAT)
		AxId is the id number in the drive hardware (only different on ZX TwinCAT control systems where drive order is different to AxNo order)
	More Standalone Saw additions:
		
4.64.0.0 02/12/15
	Track issue with lower number of axes than total
	Bug found in diagnosis when problem with Y notch code too deep found
4.63.0.0 27/11/15
	CC-015092 Skip cut on ]Y and Y[  (also F and S) cuts
4.62.1.0 27/11/15
	Change barqueries in batch load to arrays to prevent crashing on data table change
4.62.0.0 24/11/15
	scroll bars on frmMain and frmBarEdit maintain position after scrolling and redrawing
4.61.1.0 24/11/15
	Bug when there is no nextBatch and bars on hold = bars not cut now sorted
4.61.0.0 23/11/115
	sort out bugs with next batch loading when bars are held
	button on next batch "Run Now" rto clear remnants of current batch and load next batch
4.60.0.0 17/11/2015
	Additions for Standalone Saw
		Allow zero length stdops file

4.53.0.0 16/11/15
	Experimental door optimising left in optimiser - 500mm waste!
4.52.0.0 12/11/15
	More local setup additions - benchtest setups and twinCAT address
4.50.0.0 10/11/15
	log clamp states to clamps.csv uses clExtendedArray on v3.9+ back end (mint only)
4.49.0.0 05/11/15
	allow customr setup loading from a different directory, ask=<dir> as first line in masterdir
4.48.0.0
	Allow tolerance of 2mm on optimiser length check - prevent endless reoptimiser loops
4.47.1.0 30/10/2015 
	bUG IN GETaLARMfROMlINE, NOT READING IN INPUTREF!
4.47.0.0 28/10/2015
	Ensure 031 outfeedBeam Alarm has not bee bodged to check for outfeed beam input - should be undefined
	Ensure timeout on infeed Pull out alarm is set to 150
	Ensure 320 idle timeout alarm is switched on by default
	
	To stall the gripper, 
	Change offcut2 from 1320 to 1520
	I have a length of outerframe code 11500 @ length 1500, manual input a 4000 vent position 1350 will softly stall the X axis.

4.46.0.0 21/10/15
	4.29.0.0 change for shortPieceTrap has a bug if the next position is negative movement back into clamps (CC-014653 Invision)
	Changed so that only does the trp move if the next bar opertion position is further out than the clamp position
4.45.0.0 12/10/15 
	Additional back end alarm  320 for idletimer error. Needs v3.70 back end
	Sort bug with duplicate toolBreakError
	Write to diagnostics axis file full AX extended array(if spindle monitoring enabled via parameter useMachineUpload) to help trace idle issues in future
		Position, Following error, Status, Error Code, Idle, Velocity
	Axes loggable with dbLog tickbox on axis setup

4.44.1.0 09/10/15
		Gap waste and length cut off now combined in eject command. 
4.44.0.0 08/10/15
		Ensure SMOT is a stoppable output on Io load
		Batch loading creates entry in diagnostic file
4.43.1.0 07/10/15
		Optimiser bug if Knife and Fork optimising has been done, then follwoed by an optimiser error. The K&F offcuts are lost but the offcut is still in machine!
4.43.0.0 06/10/15
		Continue with pieceLength transmission to Microline back end to get barEndPosCalculation correct
		Visualiser screen to reflect positions of machine - can be developed in future
4.42.0.0 05/10/15
		Send gapWaste and piece length to microlines so it can calculate the end of bar correctly
		GapWaste on gapWaste command
		PieceLength on eject command, var 2
		ANOTHER BUG IN MINIMUM OFFCUT CALCULATION. Now sorted minimimOffcut = lengthUsed + ESgap, NOT -ES gap
4.41.0.0 02/10/15
		try / catch in backup to stop error if file of same name is being added
4.40.3.0 30.09/15
		Double check on optimiser - check that offcutlLength is positive as well as lengthused 
4.40.2.0 25/09/15
		Error calculating length used - was the offcut length
		lengthused        total of pieces used, plus a SQ gap on end
        minimumOffcut     smallest offcut needed to get all pieces on a bar - uses ES gap at end
							THIS ALSO CURES BUG CREATED IN 40.1 THAT STOPS THE CHECK ON OPTIMISER RESULTS WORKING BECAUSE minimumOffcut calulated incorrectly
4.40.1.0 22/09/15
		Following CC-014367 GRM Batch crashing, the optimiser was in an endless loop calculating the wrong waste / offcut length
		Not clear exactly what the offcutLength, lengthUsed and wasteLength parameters meant, so defined them:
		lengthused        total of pieces plus gaps ES on each end
        offcutLength      offcut left over when pieces cut out of the bar - uses SQ end
        wasteLength       length of waste offcut including triangles - usd to ensure it gets choped up properly
 
		Bug was in checking if optimiser had cacluled correctly, it was looking at >[ (negative amount due to overcut of arrowhead) not >E (just the kerf)
		
		 
4.40.0.0 21/09/15
		Add piece number to pieceStart and End in diagnostic log to help link machining time to video
4.39.4.0 18/09/15
		Bug in optimising lengths > stdlength, get Incorrect offcut loaded error.
			Traced to change made in previous version, now optimises rest of bars to longer length
		Mod to Update made in v4.29.0.0 for holding small piece at end of bar - value extended from 1200 to 1350 to capture issue seen on longer bar length see CC-14341
4.39.3.0 10/09/15
		Bug found when single piece / knife and fork optimising used, did not reset the wrongResult flag when it had optimised it ok
		Led to a stdlength being sent to back end when an offcut was measured
4.39.2.0 10/09/15
		Manual cuts on Autoflow incorrect - finish position was shortfall, should be mlSaw
4.39.1.0 09/09/15
		ph_DEBUG_STEPMODE and ph_PHASE_SCALING on same pigeonhole number
4.39.0.0 07/09/15 
		Updated decelDivisorGlobal default value from 10 to 1 to prevent it slow on software updated
		Check on optimiser results, reoptimise if negative remainder with increasing AA / RA values
4.38.0.0 02/09/15
		New parameter - phaseScaling for scaling the feedback from the phase monitor module
4.37.2.0 30/07/05
		Pos test does not work - batch is nothing when it calculates which trips up calcRemainder
4.37.1.0 30/07/05
		Bar from Sidey (Batch 202513 Pcs 61, 67, 68, 80, 66, 96) shows optimising still wrong
		Bodge AA and RA to make work AA=maxable not trim
4.37.0.0 28/07/15
		"Knife and fork" optimising of offcuts - just look for pieces that fit in offcuts before main optimising event and remove from list
			- This ensures that short offcuts are ALWAYS used if possible
			- If the bar edit screen says the minimum is 700, then 700 WILL WORK.
		Settled on AA value of trim + kerf*ROOT2. tested on 18xf3190f bits trim=250, kerf = 38 160 for Y minable waste. Total used = 59916
			- clears at offcut = 59940, fails at offcut=59930. Very close to what is required
4.36.1.0 27/07/15
		Bug when measured length longer than expected length, now tied down to >0 <trim
		Bar editing disabled if bar is being measured
		Cutcheckbox in bar edit disabled for working bar
		Optimising put back to AA=maxable+minable and RA=-2000. This gives poor optimising but at least it works without "overoptimising"
		Bug with offcut length not appearing sorted
		Manual machining pieces - baroperations added from bar end, do not include handing or piece information
4.36.0.0 24/07/15
		Reprogram manual machining as not at all correct in previous versions. Now ensure the operation position is added from the bar End not the piece end
		Reversal of operation position on Manual batch cuts now removed - only on manual singles
		Parser now used for gap calculation 
		** NEEDS SAW SOFTWARE V3.48.0.0 to match ** 
		Set optim.ini AA=0, RA=0 so it has to optimise without "quick shortcut"
4.35.1.0 24/07/15
		Had to reverse changes to optim.ini as it was creating negative remainder
4.35.0.0 23/07/15
		Changed optim.ini parameters to fixed low values after discussion with Simon Tate (AA=100, RA=-100)
		Tested with f1000f piece and 0.5mm difference showed the optimise / not optimise limit working correctly
4.34.0.0 15/07/15
		xholds now implemented
		on launch, set flag to identify that fparameters have changed, so force download of updated parameters
		operation logs 
4.33.2.0 14/07/15
		Bug with Manual Machining on Microline - handing issue on L to R machine, and eject operation missed
		NOT SORTED YET FOR AUTOFLOW!
4.33.1.0 14/07/15
		Bug with drive numbering. Axis number starts from 0 on Baldor, 1 on TwinCAT
4.33.0.0 10/07/15
		Manual Machining are now full batches. Moved it from bar related to batch related
			- set all gaps to zero
			- piece length = minimum piece size for the operation selected limited by minPieceSize Parameter
		All now compatible with next batch loading system
4.32.0.0 07/07/15
		Updated maxIO size from 400 to 500 for twinCAT v3.00 program
		Problem with confusion between axis number and axisIs. Changed now so that axis number increments on each loaded axis, starting from 1
		Field 2 now contains the iD number of the axis, particularly important on TwinCAT where the order of axes is not the same
4.31.2.0 01/07/15
		trace samoffcuts to find bug wth .0 length
4.31.1.0 01/07/15
		Sorted bug where manual inputs do not work
4.31.0.0 29/06/15
		Change bar / piece structure to allow secondary batch loading. Optimises within batch only
		nextBatch and currentBatch pointers used.
		On load batch it loads on to end of current batch. Also with remakes and manually created batches
		Calculate total operation time from default list
4.30.0.0 19/06/15
		Output a decelDivisor command after speed command to instruct back end to reduce decelleration to improve accuracy of slots
		This has been implemented for all slots, but is slowing machine down on those slots that do not need it.
		New parameter
			decelDivisorGlobal, range 1 to 10 allows the divisor to be changed globally (1 will disable, 10 is 1/10th)
		New command
			decelDivisor=nn allows modification in each program - fast slots will have =1. Add before a speed command

4.29.0.0 17/06/15
		trapShortPieceFall now expanded to Microline end cuts on compileBarOps following id of problem on M013 at Precision CC-013479. Video available
4.28.0.0 01/06/15
		trimming calculation changed to look at stdLength-length not abs(length-stdlength).
		This ensures trim cut is done on bars much LONGER than std length (happens at Premier Wales on their use449Forstdlength system)
4.27.0.0 21/05/15
		add analog inputs to IO definition, type 3
		Alarms inputstate now an integer, not boolean. 1 or -1 = true, other numbers used to test analog input values
		Means input state needs to be On, Off or a number
		On batch load, batches with same name were not overwritten becuase .44o file was used. Now only reverts to original .44o file if loading from old batches
4.26.1.0 19/05/15
		Bug on remakes since v4.26.0.0, filtered all remakes out with barIndex=0, changed filter to >=0 
4.26.0.0 12/05/15
		Move offcuts to the front end of bar on Microlines. Stops heavy offcuts of around 800mm tipping out of clamps
		Controlled with new paramters - offcutShiftMin, offcutShiftMax
4.25.0.0 08/05/15
		Backup on Autoflow now works - rogue destDir creation removed
4.24.1.0 06/05/15 
		only check spindle monitors if spindle monitoring on
4.24.0.0 05/05/15
		Upload data from Baldor controller - machineUpload(). Length defined by
		Requires mint v3.38
		Swicthed on / off with new parameter useMachineUpload
4.23.0.0 24/04/15
		Use length given in 449 file as standard length. New parameter use449ForStdLength. Relies on 449 file having ONLY std lengths in, not offcuts
		Replace all references to stdLength with getStdLength. Will always default to the profile.mul stdlength
		If multiple stdlengths for colour in the same batch, will use the latest one, this should rule out offcuts in most cases
4.22.0.0 23/04/15
		Fixed bug when creating postest from test screen with .44o file
		Fixed bug where V notches not calculating a footprint, so mrdummy not working
4.21.0.0 14/04/15
		Revisited offcut calculations, after discovering issue with large gaps on saw software.
		Offcutlength calculaed from miSQ, not miES at all times
4.20.1.0 02/04/15
		Bug found in 
4.20.0.0 01/04/15
		New Pep for cutting square ends as tilt angle. Set for profile type, means 3rd party software not relied on to create VS tilt cuts
4.19.0.0 24/03/15 
		Make extra copies of original batch and ZEB file when loading from fresh. Use these batches for remakes
		New parameter optimiserYieldLimit, defaults to 0. This will retest optimiser with increasing thresholds to get best yield. Leave at 0 to disable
4.18.3.0 24/03/15
		DELETE_AHADJUST = True - uses peps for AH adjustments
4.18.2.0 19/03/15
		Ensure old batch files of same name are deleted before loading new batch. Helps to ensure ZEB files are created if PRN files only exist
4.18.1.0 19/03/15
		Fix bug with fine adjustments missing
4.18.0.0 17/03/11
		Delete .zeb and .prn manual files on load - prevent error on ZEB file creation
4.17.0.0 13/03/15
		Print a label with BLANK LABEL on it rather than error message
4.16.0.0 17/02/15
		check results from optimiser if offcut length is expected. create an error if a problem
		use wastelength not offcutlength when calculating throwaway
4.15.1.0 13/02/15
		trap missing zeb data on label print to prevent crash
4.15.0.0 12/02/15
		Trap gripY position not on centereline of profile on Microline
4.14.1.0 30/01/15
		bug in gap comparison when calculating skipCut AGAIN
4.14.0.0 06/01/15
		Fine adjustments tab properly implemented for Microline
		
4.13.1.0 18/12/14
		bug in gap comparison when calculating skipCut
4.13.0.0 17/12/14 
		Disable shortestpieceAvoidEnd as it messes with optimising on normal machines
		Ensure overlapping preps identified at initialisation stage - mnd file loading
		Removed all links to MS office
		Had to remove <startup> added junk in app.config to get the program to run on .NET 3.5. Must have been added when attempt to add SQLite under .NET4.0

		Branch to v5
4.12.0.0 10/11/14
		frmSettings/Fineadjustemts/arrowhead offset max changed to +/-9.9 as bigger offsets are required for odd profiles
		allow manual op entry near end of bar if the pieceqty is >0 - ie creating batch of pieces
			also allow Y notch codes if the useSawForYnotches is on
		bug in canSkipCut - not calculating gap at all, so always zero
4.11.0.0 07/11/14
		create a new profile system if it does not exist. prevents crashing on frmSetting load
4.10.0.0 31/10/14
		Add parameter debugStepMode and pigeonhole ph_DEBUG_STUP_MODE
4.9.0.0 27/10/14
		minimum bladetofence parameter on frmSettings changed from 30 to 5. Problem if profile width < 60 or if smaller offset wanted to centralise clamps better
4.8.0.0 16/10/14
		Bug in 4.0.0.0 onwards if bar has no operations
4.7.0.0 10/10/14
		new parameter reverseOptimisationOrder.
			reflects the piece preps and gaps as sent to optimiser, then reads piece back in reverse order. 
			Looking to try to place short pieces at the start of the bar on left to right feed Microline machines, as short bits at end create a big problem in clamping
4.6.0.0 09/10/14
		Blank filter on fine adjustments on frmService load - stops crashing
		StugaLog v3 database, remove entrylog and links, including GuIds
		Application terminate on initialising if no connection
4.5.0.0 09/10/14
		log diagnostics bus tidied, potentially causing crashes when logging recipe
4.4.0.0 09/10/14
		skipThrowawayMitreCut parameter added for A2007 to stop the mitre cut which causes problems with the clamp on top of the gripper arm
4.3.0.0 06/10/70
		wastelength not calculated correctly. Should include endgap, not exclude
		minimum minoffcut is now 300 not 700
4.2.0.0 02/10/14
		reflectOrder optimisation to attempt to make short pieces go at start, not end of bar
			switch end preps and piece preps
			read back in opposite order
			Do something with the optimiser string!
		add granualrity to diagnose process to stop 5 second wait on exit
4.1.1.0 19/09/14
		ensure no writing to logDb if useEntryLogging False
4.1.0.0 18/09/14
		Add width modification on bar queue screen
4.0.2.0 10/09/14
		canSkipCut returns false for any gap > kerf
		Y notch offset min and max now +/0.2
4.0.1.0 Sep14
		Bug in sending sawfeeddirection - need to set sval as well as ival...
4.0.0.0 Sept 14
		Log IO, Axes, Alarms, operations to database referenced to ticks
		Log changes to data only
		new parameter useIncrementalSAM forces software to use incremental SAM file tracking to ensure the order is maintained

3.103.2.0
		Create diagnostic Label file if it does not exist
3.103.1.0 22/08/2014
		DIAGNOSTIC_TEST added to alow benchtesting of label, a few bugs sorted
		$BN$ (build number) allowed on any label
3.103.0.0 21/08/14
		Log axis and io channels to database v2 switch on with useEntryLogging parameter
		Other new parameters control sampling rate - dbTickInterval and dbDumpInterval
		New parameter on IoDef to log the io channel
		New Parameter on axis to log the axis data
3.102.1.0 18/08/14
		Bug found on 3.100.0.0 when trapping stdlength - rounding error on measured length
3.102.0.0 13/08/14
		check zeb files for piece number completeness
		check batch files are copied correctly
3.101.0.0 08/08/14
		ph_THROWAWAY used for shortfall and throwaway ph-download - probably no effect as all throwaway calcs done on front end level
		Output a diagnostics label option - switch on with useDiagnosticsLabel
			uses diagnostic.zft
			$$OPLOG$$	- optimiser log for bar
			$$GAP>$$, $$<GAP$$		- Calculated gap
			$$CPOS>$$, $$<CPOS$$	- Calculated X axis position
			$$PPOS>$$, $$<PPOS$$	- Previous X axis position
			$$FOLER>$$, $$<FOLER$$	- Following error when cutting
			$$TIME$$				- Time Produced
			$$DATE$$				- Date Produced
3.100.0.0
		trap optimiser failing to use short offcuts and assuming std length
3.99.0.0
		Add search for $BN$ in zebra file, replace with Build number of machine
3.98.0.0
		Change bar operation sort method to sort by position, then by tool code. Allows EcoPlactic wood to sort operation order by toolcode name
3.97.0.0
		disableOfConveyor parameter for disabling outfeed conveyor on MkA Autoflows. uses ph_DISABLE_OF_CONVEYOR
3.96.2.0
		Bug in checking if database exists
3.96.1.0
		Check StugaLog database exists before attempting anything with it
3.96.0.0
		Link to StugaLog Database with heartbeat and piece / bar log
3.95.0.0
		Extra saw cut prep scBLW. This makes it different to scEJ so the back end can deal with differently
		Controlled with useBlowerForEndPiece parameter
		Passes ph_BAR_MIN_OFFCUT to back end for faster and more reliable checking off offcut length
		New Parameter throwawayChunkSize defines piece size that offcuts<throwaway are chopped into until smallest grip is left 
3.94.0.0
		On remainder calculation, check offcut is useable and use miSQ or miES as appropriate
3.93.4.0
		bug on displaying null operation headers in bar data 
3.93.3.0
		mitreCutOffset min / max now 5 not 1
3.93.2.0
		DEFAULTVAL HAS TO BE -1!
3.93.1.0 
		DEFAULTVAL on PEPS now -99999 as -1 causes problems when the value is -1!
		reduce text size on fine adjustments
3.93.0.0 25/06/14
		Delete button on batch load screen raised higher at request of Polyframe
		Fine tuning tab for Autoflows, allows tuning of mitre cut length, arrow head position, V and and Y notch depth in one place.
3.92.0.0 24/06/14
		Bug in footprint calculation since variable op length added. Now calculates on each piece operation by looking at mr lines only
3.91.0.0 13/06/14
		Backlash compensation option on saw cuts - sawBacklashMove parameter - NOT COMPLETED, NOT USED
3.90.1.1 11/06/14
		New Peps frontYAdjust and rearYadjust. Allows operator control over Y notch depths on useSawForYNotch
		Appears on Notching screen
3.90.0.0 08/06/14
		Force Y notch codes to be cut with saw blade using new parameter useSawForYNotch **AUTOFLOW ONLY**
		New saw cut types YFLEAD, YFTAIL, YRLEAD, YRTAIL sent to back end with saw cut
		depth of cut sent in tilt angle field

3.81.0.0 04/06/14
		Ensure rComms set correctly on startup so Autoflows display correct message
3.80.1.0 22/05/14
		Tooling menu crash bug fixed. Now clears bar queue, reinitialise, then reload bar queue
		Fixed issue with panel click event, made the text box fill the panel
3.80.0.0 20/05/14
		Notching parameters now in new settings tab. Don't need to exit winMulti to change
		System checks profile.mul and stdops.mul exery 5 seconds, prompts for update, but only if queue is empty and machine is idle. Do not need to exit winMulti to update
		DXFs converted to bitmaps on loading. If bmp already exists, load bmp instead. Speeds up loading process considerably.
		Blade height dxf now loaded when profile chosen on settings screen - may introduce slight delay. 
		Blade centraline on picture now reflects any change to bladeoffset PEP.
		Fixed bug with on / off parameters and combo box parameters not updating back end - needed to set param.sVal
3.79.0.0 16/08/14
		New parameter firstCutOverHeight - on autoflow, the extra height added for first cut on the bar. 
		new PEP - trimSquareFirst. Ensures a square end on first trim cut to prevent blockage
3.78.0.0 08/05/14
		skip the lead mitre cut on throwaway if the end prep is already a mitre
		trim for chutewidth / smallest grip like throwaway with a mitre on the rear, skip if already there
		storeOffcuts parameter, defaults to 1
3.77.0.0 08/05/14
		SlowGain parameter max increased from 5 to 100
3.76.0.0 29/04/14
		Deal with measured length > std length by changing the profile's standard length for next optimisation
3.75.0.0 22/04/14
		Attempt to optimise short pieces away from bar by end prep modify to mechanical
		Use new parameter shortestPieceAvoidEnd. If piece shorter than this then invoke, so switch off using shortestPieceAvoidEnd=0
3.74.0.0 17/04/14
		Bug found reading in profile.mul. Field 2 used as reverse load, should be field 6.
		Field 2 is "Flip"
3.73.0.0 17/04/14
		New Parameter useUnclampSawOnReverse, default True. Switch off side and top saw clamps on autoflow on x axis reversing
3.72.0.0 11/04/14
		max measureEndPosX incresed to 7300
		new parameter parkPositionR
3.71.0.0 09/04/14
		More diagnostics in label printing
3.69.0.0 02/04/14
		Disabled autoqueue move if not a sawing centre
		Bug in reconnect TwinCAT found
3.68.0.0 26th Mar 14
		if controller disconnected, attempt reconnect
3.67.0.0 19th Mar 14
		In parameter read / write, try 5 times if a twinCAt error happens
		Application Terminate dealt with on service screen updates
3.66.2.0
		Debugging around label printing
3.66.1.0
		Still calculating offset to zero
3.66.0.0 14 Mar 14
		Bug found in 1st time startOffset calculation from 3.60.0.0 - startOffset calculated as zero! -> Heritage issues with v notch calc, EcoPlasticWood issues
		Startoffset needs to be processed and added before sort order of and compileOps
		Moved startOffset calculation to sit with pieceOperation as well
		Identified in operationHeader where the startOffset line is extracted, allowing parsing of this line only at a later date
		Moved the variable to parser functions to modGlobal as called now by both clPieceOperation and clOperationHeader

3.65.0.0 Mar 14
		When bar length > offcut on table, reoptimse
		'Sort bug with position of variable length slots
		Merge batch now copies operation length data

3.64.1.0
		bug in checking starterRecipe
3.64.0.0 12/03/14
		New parameter useSawInfeedTopToggle. set true to toggle off / on saw infeed top clamp on last cut on autoflow
3.63.0.0
		New parameter - useGripRelease. Allows Autoflow to use the grip release check input3.59.0.0 12/02/14
		Changed ifreversed characters to correct reverse ones on m/ and \i reversal
3.62.0.0 05/04/14
		Read back recipe after writing to ensure data transfer is correct
3.61.0.0 03/03/14
		stopped maxable cut on autoflows for SQ YF and YR. Not needed and creates a space for errors
3.60.0.0 18/02/14
		Changed recipie to sit with pieceOperation, not operation due to variable length ops

**** Changed to newest at top to save me scrolling down!! *****
=================================================================

1.0.0.8	Jan 2011
		Compiled on VS2010 - issues with BCParserLib
		IO bugs for baldor connection
		A2001-56 Splashscreen added
		A2001-61 PRN file loading error when piece does not exist removed
		A2001-59 Manual labels added
1.0.0.9
		On service screen, radio button for Mk3 set machine type to microline
1.0.0.10 Jan 2011
		Replicate uses property to retrieve from the code
		Process piece labels generated in SAMOUT for flowline compatibility
		on batch write, add final character for iscut piece
		on batch read, read in isCut character
1.0.0.11
		Re-hashed the entire handing system and tested
		PlcReset in reinitialise machine - connects to port 811
		use = false stops operation compilation
		bug - wait time was output as wait input 
		bug - manual operations not setting use and exists flag
		Laser hole stopped working because use flag now used, sorted
		bug - if moveabs on R<360 added 360, should have been <0
		wait routine was not working
		Saw cuts did not exist on microline - pieceOperation for saw cuts did not set used flag to true
		Endprepmodify modifies the prepChrs property so passed to saw correctly
		endPrepModify works on non-sawing operations only
		Interpret circle bugs in calculating radius
		Sleep on second label print to prevent crashing
		label disabled on manual machining
		Disable error detection after ftp shell command - not an error anyway
		SAMOUT folder is scanned for SAM files
1.0.0.12
		Current Batch on front end
		work.449 now holds a pointer to the batch
		Hold and cut information for each bar stored in archive for batch
		Cut information for each piece stored in archive
		New baredit screen - Pieces "cut" can be edited
		Colours for bar status on front screen
		Remakes working
		Splash screen shows version number automatically
1.0.0.13
		on optimising one bar, use the offcut closest to measure length with margin of 25
		Bar holding bug - held / unheld all bars now sorted.
		If double plunge off, tilde files are used
		Recipe display is numbered with Blue highlighting each operation
		Recipe line received back on ph_RECIPELINE
1.0.0.14
		Better batch filtering for errors in file
		New parameters ps_PushToBf, psInfeedGrip, chainSensor for ZX3 compatibility
		Bug if AHAdjust was empty - on populate the settings box. Now disabled for non-microlines
		loadingpos range changed to +100
		Do not output manualMachining bar to autoqueue
1.0.1.0
		startOffset is inverted to previous version. This is correct, but means any machine on other software should invert startOffset 
		Stop output of ops on bar queue
		made sure archivedir is in sharedir
1.0.1.1
		Recipe line number now updated correctly
		Allow more than one remake
1.0.1.2
		update449 after bar finished
		bug crash if AHAdjustments file pointed to different profiles
		better handling of short offcuts
		minBarLength added to clPiece
		minimum offcut size on front screen
		prevented reporting of exception on batch save
1.0.1.3
		use fixed arrays when writing batch in case it is updated while writing
		when offcut measuring, if it same length as stdlength, subtract 0.1 to stop optimiser fault
		new parameter barQueueView
1.0.1.4
		Profile prompt working - needed to autonumber pIndex
1.0.1.5
		Found all timing issues slowing down in barQueue
		log time on / pieces cut / running time in running directory
1.0.1.6
		WaitUnload command in recipe to force machine to wait for ejector returned before x axis move near end of bar
		Fix maxable cut at start of bar
1.0.2.0
		isFileOpen added on SAM file processing


2.0.0.0
		Graphical bar queue
		Revamped offcut measurement and processing
2.0.0.1
		Reload All option on load screen - allows full batch reload from old batch
		Bar Queue with checkbox for cut / not cut
2.0.0.2		
		DXF loads replicate if not there
		Manual piece input works with front end
2.0.0.3
		SAM file processing takes right 4 digits for piece number and the remainder as the batch - allows SAM data < 12 digits
		Remake PRN labels
		On load of non-zeb batches, a zeb file of the prn is made so same file printing works
		Front/ rear Y notch check in canSkipCut
2.0.0.4
		Remake batch selection caused a phantom queue
		Bug when processing SAM files when data < 12 digits
		F2 opened manual saw input
2.0.0.5
		Backup now sorted for flowlines - multi and saw folder and zipped up - needs Ionic.Zip.dll
		Credibility check on stdops.mul
2.0.0.6
		Faults in DXF files causing EOF exception now ignored
		autoqueue outputs need to be padded with Zeroes to maintain compatibility with DOS saws
		Blank line added in sparams.saw to maintain compatibility with DOS saws
		autoQueue batches forced write as ASCII to maintain compatibility with DOS saws
		One remainder line for autoqueue batch, was one for each piece
		force calculation of offcut length before autoqueue write
2.0.0.7
		Trim sam data to remove preceeding spaces
		Working now reset if runmode goes to zero
		Tilde files now loaded and used properly
		Trap error if tilde file does not exist
2.0.0.8
		Check existence of dll files
2.0.0.9
		Look ahead on saw cuts for the next Y / Z / Tool command to do it during saw cut
		Graphical map of pieces cut and on time
		useSiren parameter
		peremptiveSawing and premptiveMachining parameters
		preemptive maching uses a fake tool command, extra variable to tell back end to abort before the plunge
		useFastLoading parameter to overlap sawing and machining
2.1.0.0
		Disable main screen buttons while machine running 
		Separate bar and piece source for remakes
		PEPS - profile extra parameters file. 
			First parameter = popup, along with new fparameter ph_BAR_POPUP to facilitate 6m popup on any particular profile
2.1.0.1
		Bug on remakes - doing 2 for each
		Postest and lintest added 
		reverseTime PEP on parameter 2
		On the fly parameter changes
		Fix bug with replicate profile dxfs
		Eject Stroke length properly added as a parameter
2.2.0.0
		amsNetId variable downloaded to twincat as new parameter amsNetId
2.2.0.2
		bladeClOffset parameter added to allow for saw blade centreline mismatch
2.2.1.0
		Hold queue activity when creating manual batch to prevent crashing
		PEP 3 added for saw cut speed
		Range for bladeClOffset parameter incorrect. Now +/- 5
2.2.2.0
		minPieceSize parameter and batch loading length validation
2.3.0.0
		Spindles Tab on IO Screen
		PEP 4 added for traverse speed
2.4.0.0
		Remakes have 8 characters, not 6
2.4.1.0
		Accuracy setup, mitre change for 1mm, now 0.5mm
		Make single instance program on settings
		Manual batch input label bug fixed
		PosTest and Lintest working
2.4.2.0
		cint error capture in SAM file
2.5.0.0
		Pep class merged with profile
		sawCutHeight, sawChipHeight, sawChipSpeed parameters added for profiles
		PEP editor implemented
2.5.0.1
		Bug on display of Popup - defaulted to true not false
		Blank profile on prf setting if pic does not exist
2.6.0.0
		Eject buttons on alarm screen to move eject if stopped
2.7.0.0
		Cancel picture loading on initialisation screen to speed up testing
		Operation Header names all converted toUpper text to prevent string comparison error
2.7.0.1
		Outfeed Table size min limit changed to 1850
2.7.0.2
		look for profile mul change every 1000 seconds
2.7.0.3
		HUGE bug when checking for profile dependendent ops
2.7.1.0
		useVariableTilt parameter. If tilt in 449 < useVariableTilt value then intermediate pos will be used
2.8.0.0
		mitrecutOffset parameter for adjusting profile lengths that go under the clamps
2.9.0.0
		Group set PEPs on profile tab
		On setup mode click - auto reinitialise
		tiltLengthOffset Parameter
2.10.0.0
		Ensure ejector home on manual test batches
2.11.0.0
		Extra controllerType=4 for E100 control via USB
		Bug found with case " or ", needs to be case ","
2.11.1.0
		Bug on i/o manual display
2.11.2.0
		griprelease added to chutewidth chopping cuts
		Avoid blank zebh data lines when ftp printing
2.11.3.0
		Output batch files as ASCII
2.12.0.0
		Diagnose axis positions and io states every 100ms
		Bug on unknown profile and piecelength < minimum, now skips piece operations until next piece
		if laser operation does not exist, skip laser hole with a message
2.12.1.0
		On new bar, all operations interpreted to overcome no interpreter code at Nationwide
2.12.1.1
		Bug in laser hole reporting - switched it off if it did exist
2.13.0.0
		Extra parameter datumBarEndYZ to datum at the end of every bar on Y and Z axis
		Disabled Diagnose axis positions and io states every 100ms
2.14.0.0
		ph_SMALLESTGRIP constant added to download to backend
2.14.1.0
		Remove changes for taller profile end of bar
2.15.1.0
		add square end if there was a tilt on the last cut
2.15.2.0
		move square end on tilt offcut 20mm up the bar to ensure cut happens in correct order
2.16.0.0
		PRN file copied to saw batches folder on batch load
2.17.0.0
		New parameter and fparameter clampITDangerZone
2.18.0.0
		Queue button added to bar edit screen to allow independent generation for saw queue
2.19.0.0	Sep 11
		PRN files generated on remakes (and always). Issue when flowline saw uses PRN files only
2.19.1.0
		Bug found in downloadDefault - single to integer conversion
2.19.2.0
		Bug in above change - default value not used
2.20.0.0
		Diagnostics in label processing
		mutex to ensure labels not processed twice
		bug on 2 labels when prn only printing via ftp to zebra (phew!)
2.21.0.0
		Attempt to track down no operations bug
		Dump operations if profile and toolcode search returns nothing
		If toolcode does not exist on loading, create a null operation, exists=false
		if operation.exists = false, do not use it
		If profile and toolcode returns nothing, forse program exit to prevent no operations
2.21.1.0
		Bug found in sam file processing from v2.21 - prints both prn and zeb labels! Now uses zeb only if it exists
2.21.2.0
		Left a test line in!
2.22.0.0
		Looked at final square cut and found an extra square cut added in addSquareEndOffcut, effectively doubling it up
		Now removed and all square cut calculation done at the end of bar.interpret
2.23.0.0
		Clear Blockages form for Microline initialisation issues
2.23.1.0
		Swapped arrow directions round on SR axis clear blockages
2.24.0.0	Sep 11	GMG
		Illegal profile combinations added using new parameters illegalComboLeadWidth and illegalComboFollowWidth
		if lead profile width<illegalComboLeadWidth and follow profile width >illegalComboFollowWidth, the follower is placed on hold in the queue
2.25.0.0
		new parameter waggleOnTall1stCut. Profile height taller than this will force a waggle on the first mitre cut on the bar to help tall offcut fall down the chute
2.26.0.0
		if demo mode, do not print labels
2.26.1.0
		Demo mode label on front end
2.26.2.0
		Demo mode off disables printing! False not true
2.27.0.0
		Toshiba printer interface - use connectmethod = 2 (TCP transfer) and printer=5 (removes unwanted peel-off commands)
2.28.0.0 Nov 11
		When calculating smallestgrip cut, take into account that the cut may come before the mitre cut after compiling
2.28.1.0
		sideClampSmallestGrip parameter to switch off side clamp when ejecting small piece to prevent gripper bending
2.29.0.0
		Alarms logged in diagnostics, only update screen if changed
2.30.0.0
		Alarms with Enabled and notInDemoMode flags
		reverseMeasure PEP implemented to measure the operations from the other end
		winMulti Icon
2.31.0.0
		Jumping bar queue bug fixed, removing status / running diagnostics display from frmMain cured problem
		If disconnected from back end, Fatal error exits
		Fix bug for multiple alarm writing to diagnostics
2.32.0.0 Jan 12
		Read offcuts from OffcutDir
		Parameter readOffcutsFromSaw allows toggling of function
2.33.0.0 Jan 12
		Allow winMulti to reverse preps sent to saw with writeReversedPrepsToSaw
2.34.0.0 Jan 12
		trimStart parameter added, along with mateSpeed, yTrimSpeed, zTrimHeight
		Extra pep "skipTrim" to skip the trim cut for certain profiles
2.34.1.0
		trimStart parameter moved to "configuration"
2.34.2.0
		Bug in interpetation of ph_BAR_TRIM. This is part of the "Clamp word", not a fparameter on its own. 
2.35.0.0
		New parameters for psInvDecel50Hz and psInvDecel300Hz. Set to 0 if inverter not used (on a std Mk3 ring).
		At end of batch, do not load next bar
2.36.0.0	feb 12
		bug setting grip y pos with version 1 profile.mul sorted
2.37.0.0
		accuracyTest flag and pigeonhole added
		log following error on ph_LANDING
3.0.0.0 April 2012
		Microline compatibility
		Added cut pairs and W_mnd files
		Rewrite of handing system
3.1.0.0
		Merge batch tab on loadBatch - creates a MRGnnnnn batch file set, all renumbered
		Bug in remake numbering found and sorted
3.1.1.0
		toupper used on batch filtering
		merge batch filtering implemented properly
3.1.2.0
		Bug found in reading back optimisation result, wrong function used to determine order of pieces
3.1.3.0
		Bug found on building prn file for merged batches, reading loop not terminating
3.2.0.0
		Added better error handling to printer commands. If there is a printer error, the label file is not deleted and it will keep trying
3.3.0.0
		diagnostics on housekeeping and timing on sclick
3.3.1.0
		Matespeed discovered to share laserspeed pigeon hole. Changed to 281. Needs v2.03 back end.
3.3.2.0	May 12
		Filter bug if mnd file corrupt on "?" variable line
3.4.0.0
		Bar processing timers added
3.5.0.0 Jun 12
		Downloading recipe taking nearly a second, so added starterRecipe. This is 200 commands long and is downloaded in 50ms
		so machine can start working quicker. Needs multi v2.10.mnt
3.5.1.0	Jul 12
		Trap corrupt queueno file error
		remakes go back to 1 on 99999, not 999
		Diagnostics now log every recipie command retrospecitvely
		Alarm viewer screen allows viewing of any day's data
		Calibration linear test generator
3.6.0.0 Sep 12
		Extra parameter and ph psXReverseDelay
		Extra parameter and ph slowGain
		Extra parameters to sloadpos for gripper unload offset - add a comma at end of line to change offset to prevent pushers getting damaged
3.7.0.0
		extra parameter zebraReplaceStr to get rid of unwanted carat character "^"
		Allowed half maxable leeway to optimiser before rejecting short lengths. Discovered that optimiser allowing offcut length of 1098 to hold 836+270 (1106)
3.7.1.0
		demo mode sends to queue
		If "Ask" is first line of mastersaw, allow various machine parameter loading
3.7.2.0
		Bug found when creating offcuts from saw - not saving!
3.7.3.0
		Bug found in optimising file naming following multi machine parameter option
3.8.0.0
		Subforms now not topmost, but move to front when selected
		Changed splash screen to transparent Stuga console
3.9.0.0
		Spindle Monitor
3.9.1.0
		Bug when cancel pressed on enter offcut inputbox in barEdit
3.9.2.0
		Bug in backup - no slash on end of directory
3.10.0.0
		Full colour info on bar display and colour editor
3.11.0.0
		Debugging winMulti for Microline
			W_MANUAL.mnd file for ejecting a manual bar
			AH offsets enabled for Microline MK1
3.11.1.0
		Found bug in loadpos calcualtions for final calculation - do not need to repeat now
3.12.0.0 Dec 12
		datumBarEndG parameter added defaults to 1
3.13.0.0 Dec 12
		Debugged problem when optimiser calculating bar use including maxable incorrectly. Now puts offcut on hold iteratively until ok.
3.14.0.0
		Prevent optimiser from having offcuts >= stdlength
3.15.0.0
		Additional parameters for spindle overload checking
		Add alarms automatically if they do not exist
			305,-1,True,-1,False,0,4,Spindle Plunge Sequence Fault,False,False
			306,-1,True,-1,False,0,4,Spindle Phase Error 1,False,False
			307,-1,True,-1,False,0,4,Spindle Phase Error 2,False,False
			308,-1,True,-1,False,0,4,Spindle Phase Error 3,False,False
		New parameters useSpindleProtect and spindleOvlFactor
3.16.0.0 Jan 13
		Trap mismatch of filename and B, line. Will now correct the B, line to ensure all matches
3.17.0.0 Feb 13
		Fixed size of service screen, last version seemed to make subforms smaller
3.18.0.0 Feb 13
		Fixed size of settings screen and manual input screen
3.19.0.0
		Changes to optimisation - skip the working bar to allow offcut update during running cycle
3.20.0.0 Mar 13
		bug with default spindle Alarm 305 repeating solved
		do not allow multiple loading of same alarm
		New parameter autoQueueNoMeasure allows output of queue files without measuring so saw can work automatically
		Improved parameter editing to limit to value types in preparation for better identification
		Additional parameter IMpointtoflat for picking up inverse mitres on Wide cuts on microline
3.20.1.0 Apr 13
		Bug found in startOffset calc if empty string
3.20.2.0 Apr 13
		filter out nonsense lines in sloadpos
3.20.3.0 Apr 13
		startOffset calculations now include operation specific variables - before it crashed when stdop variable used eg sl (slot length)
3.21.0.0 Apr 13
		Sort parameters out better with fixed strings - new type pFixed
		Bug with numeric update sorted and added ok if value changed
		Bug on reading optimiser results - reverse reading order when microline 
3.22.0.0 Apr 13
		Put Y notch end prep for optimising on short pieces on microline to prevent them locating at the tail end of the bar
		new parameter mlShortPieceLength
3.22.1.0 Apr 13
		Service screen now centralised
		Alarm input table now larger
3.22.2.0 Apr13
		Dump operations and exit if toolcode missing
3.23.0.0 Apr13
		Delete same name backup on saveParameters
3.24.0.0 Apr 13
		Set offcutUsed to nothing on optimising if stdlength used
3.25.0.0 Apr 13
		Offcut sensor calibration through service->tests screen
3.26.0.0 May 13
		If optimiser calculated incorrectly, remove last piece and add another bar
3.27.0.0 June 13
		Added 2mm grace to optimiser error
3.28.0.0 June 13
		Added Parameter useToolBreakDetect
3.29.0.0 June 13
		Added default alarms for tool break detection
3.30.0.0 June 13
		Added full maxable grace to optimiser calculating incorrectly
3.31.0.0 Jul 13
		Filter blank lines in sloadpos / loadpos
3.32.0.0 Jul 13
		Colour index added to allow colour checking on bar
		New parameter - colourPrompt turns on and off
3.32.1.0 Jul 13
		Increased infeedType range to allow for infeed type=4 (AutoflowPopUp)
3.33.0.0 Aug 13
		Added gripTurn parameter to profile.mul
3.34.0.0 Aug 13
		Added useOffcutAtStart parameter to put the nasty sized offcut (chutewidth<offcut<throwaway) at the start of the bar rather than the end. Add a square cut to chop start off square if required.
3.35.0.0 Sep 13
		Trap bar length measurements of much > stdlength. Happened at nationwide, stdlength should be 5.2m but was 5.5m. Now will increase the length but not reoptimise.
3.36.0.0 Sep 13
		Reverse radius moves on hole command
3.37.0.0 Sep 13
		if outputSAM used, prevent reading back the software SAM files
3.38.0.0 Sep 13
		Added lastPopUp parameter for pop-up style infeed tables - signifies the one that the operator loads onto (one next to gripper is popup zero)
3.39.0.0 Sep 13
		Force reoptimisation if bar has cut pieces in it
3.40.0.0 Oct 13
		Radius move reversal causes problem on ZX4 holes. need to make the reversal machine dependent
3.41.0.0
		Activated drive status panel
3.42.0.0	Oct 13
		Added trap range for useOffcutAtStart - stop problem offcut lengths
3.43.0.0	Oct 13
		Special parameter for Britdoors microline - two batch folders, one optimises, the other does not.
3.44.0.0
		Bug found in left to right feed Autoflow saw cut calculations
		removed inversion of bladetofence calcs
3.45.0.0
		Filter output of offcuts to optimiser that are less than the minimum possible to use. This should help with the failure of the optimiser to calculate the end preps properly.
		This will still not prevent an offcut wrongly utilised when two pieces are on a bar, but the chances of this happening is much, much rarer than the single piece issue
		Removed the loop when trying to optimise with an offcut of incorrect length
		Create optim.ini on the fly as the AA (accept amount) needs to be tuned to the worst case mechanical end prep (minable + maxable)
3.46.0.0
		New bar parameter ph_BAR_STDLENGTH to allow back end to decide if trim cut used
3.47.0.0
		2 new PEPs measureGY and measureGZ 
3.48.0.0
		tilt angle not correct direction on left to right feed machine
3.48.1.0
		When using bladeCLOffset, it needs to be inverted on VS cut. Added case for left to right feed
3.48.2.0
		Allow offcut sensor 8 range to go down to 4000
3.49.0.0 Dec 13
		PrepMod.mul file added and new class clPrepMod
		File format: profileTrigger,preppedProfile,FromToolCode,ToToolCode
		profileTrigger	- If this profile exists in this window frame (filter by slot number)
		preppedProfile	- Look for the defined tool code on this profile
		fromToolCode	- Look for this ToolCode
		toToolCode		- Change to this tool code
3.50.0.0 Dec 13
		new Pep skipStop -> ph_BAR_SKIPSTOP. Disables the end stop for a profile in case it is too narrow
3.51.0.0 Jan 14
		on throwaway offcuts, cut a 135 (RtoL) or 45 (LtoR) cut to stop profile catching rear fence
3.51.1.0 Jan 14
		after mod, end squard ct is turned into a mitre. Moved miter to pos-10
3.51.2.0 Jan 14
		Made a mess of is, changed AddSingleCut to addCut
3.52.0.0 Jan 14
		New Pep - bladeToFence
3.53.0.0 Jan 14
		lastPopup max set to 6
		new Peps		maxCutSpeed		- cuts at max speed of saw blade
						skipGrip		- Skips gripping 

		For EcoPlasticWood
3.53.1.0
		Fix bugs in maxCutSpeed calculations
3.54.0.0
		Bug when shifting offcutAtStart when last mitre is a Y notch - notch cuts into gripper.
		Changed offcutAtStart to an integer. 1= shift by full offcut length, 2= shift by offcutlength-minable
		offcut at start dependant on previousMi
3.55.0.0 23/01/14
		When shifting half, the offcut catches on backfence again!!!!
		Added end mitre cut like throwaway mitre to stop it catching
3.55.1.0 23/01/14
		gripper let go on final mitre cut. Adjusted shift by 10mm 
3.55.2.0 23/01/14
		shift other way 10mm
3.56.0.0 27/01/14
		[OpVar] parameters taken from operation lines
3.56.1.0 29/01/14
		[OpVar] parameters not written when writing batch
3.57.0.0 03/02/14
		New parameters for ph_POUP_POS3-8 (popupPos3..8)
		New Pep for Bar accel, downloads ph_BAR_ACCEL 
3.58.0.0 06/02/14
		Allow 12 lines of gaps with new overlap prep
		put overlapping=1 in mnd file to identify
		new parameter overlapClearance, relates to "o" distance in gaps file
		End prep is labelled "g"
